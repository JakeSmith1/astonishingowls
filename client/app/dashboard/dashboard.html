<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
</head>
  <body>
    <header class="navigation col-xs-12">
      <div class="logo">
        <img src="../../assets/logo.png"/>
      </div>

      <div ng-controller="logoutController" class="logout">
        <a ng-click='logout()' class="btn btn-default">Logout</a>
      </div>

    </header>

    <div ng-controller="dashboardView" class="savedSearches col-xs-12 col-md-8">
      <div class="top-section col-xs-12">
        <h1 class="title">Saved Searches</h1>
        <a ng-click="update()" class="btn btn-default">Update my positions!</a>
      </div>
      <div ng-repeat="item in manipulateData" class="col-xs-12 col-md-6">
        <div class="search col-xs-12">
          <div class="box">
            <ul>
              <li>Currency: {{ item.cxy }}</li>
              <li>Date bought: {{ item.date }}</li>
              <li>Purchase rate: {{ item.value }}</li>
              <li>Current rate: {{ item.refreshed }}</li>
              <li>Amount purchased (US-equivalent): {{ item.boughtAmount | number: 2}}</li>
              <li>Market value (US-equivalent): {{ item.boughtAmount * item.refreshed / item.value | number: 2 }}</li>
              <li>Gain / loss (US-equivalent): {{ item.boughtAmount * (item.refreshed / item.value - 1 ) | number: 2 }} </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="userSearch col-xs-12 col-md-4">
      <h1 class="title">New Search</h1>
        <form name="currencyList">
          <label for="repeatSelect"> Currency List: </label>
          <select ng-model='selectedCurrency' ng-options='y for (x, y) in listOfCurrency' ng-change='refreshView(); getSelectedCurrency()'></select>
          <div class="details" ng-show="historyRate.ratesLoaded">
            <p>{{ selectedCurrency }} - - ( {{ inputCurrency}} )</p>
            <p>Today's Rate: {{ historyRate.todayRate }}</p>
            <p>Last Week: {{ historyRate.sevenDaysAgo }}</p>
            <p>Last Month: {{ historyRate.thirtyDaysAgo }}</p>
            <p>Last Year: {{ historyRate.yearAgo}}</p>
          </div>
        </form>

        <div ng-show="historyRate.ratesLoaded">
          <a ng-show="historyRate.buttonShow" class="btn btn-default" 
            ng-click="historyRate.buttonShow = !historyRate.buttonShow">Add to positions</a>
          <div ng-hide="historyRate.buttonShow">
            <p>How much would you want to buy? (Amounts in USD)</p>
            <input type="number" ng-model="boughtAmount">
            <p> {{ boughtAmount }} </p>
            <a class="btn btn-default" ng-click="postToDB(); historyRate.ratesLoaded = !historyRate.ratesLoaded">Confirm purchase</a>
          </div>
        </div>
        
    </div>

<!--     <footer class="footer col-xs-12">
      <p>Made with by <i class="fa fa-heart faa-pulse animated" aria-hidden="true"></i> Astonishing Owls Inc. </p>
    </footer>

 -->

  </body>
</html>


